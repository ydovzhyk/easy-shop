"use strict";(self.webpackChunkeasy_shop=self.webpackChunkeasy_shop||[]).push([[795],{9803:function(e,t,r){r.d(t,{Z:function(){return I}});var s=r(5861),n=r(885),a=r(4687),u=r.n(a),c=r(2791),i=r(9434),o=r(7689),l=r(4676),d=r(9869),x=r(2205),f=r(2951),_=r(3214),h=r(4387),p=r(9833),m="Dialogue_dialogueContainer__FuS7j",g="Dialogue_additionalOpts__o-iwF",v="Dialogue_avatar__Snahc",j="Dialogue_textInputArea__7QqLK",w="Dialogue_dialogueGroup__CccDt",N="Dialogue_dialogueBox__Zqye0",b="Dialogue_dialogueMessage__tL3Cl",Z="Dialogue_dialogueMessageRight__KBBVw",y="Dialogue_textDate__qAQ-I",S="Dialogue_textarea__F4Goc",C="Dialogue_questionButton__et0nJ",D=r(184),I=function(e){var t=e.productInfo,r=(0,i.I0)(),a=(0,o.s0)(),I=t._id,k=t.owner,M=t.userDialogue,T=(0,i.v9)(d.Dm),F=(0,i.v9)(d.PR),B=(0,i.v9)(d.t2),L=(0,i.v9)(x.kr),E=(0,i.v9)(x.J$),O=(0,c.useState)(""),W=(0,n.Z)(O,2),A=W[0],R=W[1],z=(0,c.useState)(!1),P=(0,n.Z)(z,2),q=P[0],U=P[1],G=(0,c.useState)(null),J=(0,n.Z)(G,2),H=J[0],Q=J[1],V=(0,c.useRef)(!1),K=(0,i.v9)(x.iH),X=[],$=[],Y=!1;(0,c.useEffect)((function(){I&&Q(I)}),[I]),(0,c.useEffect)((function(){if(L.length>0&&!E){var e=L.filter((function(e){return e.newMessages.some((function(e){return e.userReceiver===F._id}))})),t=K._id?K._id:M;e.some((function(e){return e._id===t}))&&(r((0,f.vz)(!0)),r((0,f.qy)(t)))}}),[r,L,F._id,K._id,M,E]),(0,c.useEffect)((function(){var e=function(){var e=(0,s.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V.current=!1,U(!1),r((0,f.ve)()),r((0,f.vz)(!1)),H&&B&&!M){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,r((0,l.UA)({productId:H}));case 8:U(!0);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r,H,M,B,E]),(0,c.useEffect)((function(){var e=function(){var e=(0,s.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(V.current=!1,U(!1),r((0,f.ve)()),r((0,f.vz)(!1)),M){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,r((0,l.UA)({dialogueId:M}));case 8:U(!0);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r,M,E]),(0,c.useEffect)((function(){if(0!==K.length&&!V.current&&0!==K.newMessages.length){var e=K._id,t=K.newMessages,n=F._id,a=t.filter((function(e){return e.userReceiver===n})),c=function(){var t=(0,s.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!V.current){t.next=2;break}return t.abrupt("return");case 2:return V.current=!0,t.next=5,r((0,l.k1)({dialogueId:e,arrayNewMessage:a}));case 5:return t.next=7,r((0,f.fm)(e));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),i=setTimeout(c,2e4);return function(){clearTimeout(i),c()}}}),[r,K,F._id]);0===K.length?(X=[],$=[]):(X=K.messageArray.slice().reverse(),$=K.newMessages,function(e){Y="64cccb7e5b8c2eb706fe655d"===e[0].textOwner}(X));var ee=function(e){var t="",r="",s=K.userAvatar,n=K.productOwnerAvatar;return F.userAvatar===s?(t=s,r=n):(t=n,r=s),e===F._id?t:r},te=function(){var e=(0,s.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,r((0,l.Jc)({text:A,productId:H,productOwner:k,dialogueId:K._id}));case 3:R(""),e.next=8;break;case 6:return a("/login"),e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(e,t){if(!$||0===$.length)return!1;var r=F._id;return 0!==$.filter((function(s){return s.userReceiver===r&&s.message===e&&s.date===t})).length};return(0,D.jsx)(D.Fragment,{children:q&&(0,D.jsxs)("div",{className:m,children:[!Y&&(0,D.jsx)("div",{className:g,children:(0,D.jsx)(_.Z,{text:"\u0417\u0430\u043f\u0438\u0442\u0430\u0442\u0438 \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u044f",textClass:"productText"})}),0===X.length&&(0,D.jsx)("div",{className:v,children:(0,D.jsx)(h.Z,{avatarClass:"photoDialogueLeft",src:T})}),X.length>0&&(0,D.jsx)("ul",{className:w,children:X.map((function(e,t){return(0,D.jsx)("li",{children:(0,D.jsx)("div",{className:N,children:e.textOwner===F._id?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(h.Z,{avatarClass:"photoDialogueLeft",src:ee(e.textOwner)}),(0,D.jsxs)("div",{className:b,children:[(0,D.jsx)(_.Z,{text:e.text,textClass:re(e.text,e.date)?"productTextDialogueNewMessage":"productTextDialogue"}),(0,D.jsx)("div",{className:y,children:(0,D.jsx)(_.Z,{text:e.date,textClass:"productTextDate"})})]})]}):(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)("div",{className:Z,children:[(0,D.jsx)(_.Z,{text:e.text,textClass:re(e.text,e.date)?"productTextDialogueNewMessage":"productTextDialogue"}),(0,D.jsx)("div",{className:y,children:(0,D.jsx)(_.Z,{text:e.date,textClass:"productTextDate"})})]}),(0,D.jsx)(h.Z,{avatarClass:"photoDialogueRight",src:ee(e.textOwner)})]})})},t)}))}),!Y&&(0,D.jsxs)("div",{className:j,children:[(0,D.jsx)("textarea",{className:S,name:"myQuestion",value:A,onChange:function(e){R(e.target.value)},rows:5,cols:40}),(0,D.jsxs)("div",{className:C,children:[(0,D.jsx)(p.Z,{text:B?"\u041d\u0430\u0434\u0456\u0441\u043b\u0430\u0442\u0438":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044f",btnClass:"btnLight",handleClick:function(){return te(B)}}),!B&&(0,D.jsx)(_.Z,{text:"*\u0429\u043e\u0431 \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u0438 \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u044e, \u0443\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0432 \u043e\u0431\u043b\u0456\u043a\u043e\u0432\u0438\u0439 \u0437\u0430\u043f\u0438\u0441 \u0430\u0431\u043e \u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0439\u0442\u0435\u0441\u044f",textClass:"messageTextBtn"})]})]})]})})}},3537:function(e,t,r){r.r(t),r.d(t,{default:function(){return F}});var s=r(885),n=r(2791),a=r(9434),u=r(4347),c=r(8646),i=r(9869),o=r(9053),l=r(1970),d=r(4676),x=r(9462),f=r(5310),_=r(9833),h=r(7262),p=r(8064),m=r(9803),g=r(1632),v=r(9806),j="MySales_ordersWrapper__zezf+",w="MySales_ordersList__s6tus",N="MySales_orderItem__l-5wO",b="MySales_orderInfoWrapper__rgdFU",Z="MySales_orderInfoItem__zGXXl",y="MySales_orderSum__MPLUJ",S="MySales_orderBottomWrapper__P6Du2",C="MySales_waitingPhrase__o59Sm",D="MySales_message__x8quZ",I="MySales_messageWindow__BmH+V",k="MySales_dismissButton__9iaeT",M="MySales_buttonBottomWrapper__nRbFL",T=r(184),F=function(){var e=(0,a.I0)(),t=(0,a.v9)(c.Wc),r=(0,a.v9)(i.Vg),F=(0,a.v9)(c.ME),B=(0,a.v9)(c.pH),L=(0,a.v9)(o.UW),E=(0,n.useState)(1),O=(0,s.Z)(E,2),W=O[0],A=O[1],R=(0,n.useState)("all"),z=(0,s.Z)(R,2),P=z[0],q=z[1],U=(0,n.useState)(!1),G=(0,s.Z)(U,2),J=G[0],H=G[1],Q=(0,n.useState)({}),V=(0,s.Z)(Q,2),K=V[0],X=V[1],$=(0,n.useState)(!1),Y=(0,s.Z)($,2),ee=Y[0],te=Y[1],re=(0,n.useState)(""),se=(0,s.Z)(re,2),ne=se[0],ae=se[1],ue=(0,n.useState)(""),ce=(0,s.Z)(ue,2),ie=ce[0],oe=ce[1];(0,n.useEffect)((function(){e((0,l.Dy)({userId:r}))}),[e,r,K]),(0,n.useEffect)((function(){e((0,u.mN)({page:W,selectorName:P})),window.scrollTo({top:0,behavior:"smooth"})}),[e,W,P]);var le=function(t,r,s){e((0,u.E7)({orderId:t,confirmed:r,statusNew:!1})),e((0,u.mN)({page:W,selectorName:P})),e((0,d.al)({orderId:t,typeDialogue:s}))},de=function(e,t,r,s){if(e)return X({orderId:e,sellerId:t,productInfo:r,customerId:s}),void H(!J);X({}),H(!J)};return(0,n.useEffect)((function(){document.body.style.overflow=J?"hidden":"unset"}),[J]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:j,children:[(0,T.jsx)(h.Z,{currentSelector:P,handleButtonClick:function(e){q(e),A(1)}}),F.length>0&&(0,T.jsx)("ul",{className:w,children:F.map((function(e){var t=e._id,r=e.orderSum,s=e.orderDate,n=e.orderNumber,a=e.products,u=e.productInfo,c=e.client,i=e.statusNew,o=e.confirmed,l=e.sellerId,d=L.find((function(e){return e.orderId===t}));return(0,T.jsxs)("li",{className:N,children:[(0,T.jsxs)("div",{className:b,children:[(0,T.jsxs)("div",{className:Z,children:[(0,T.jsx)("p",{children:"\u041f\u043e\u043a\u0443\u043f\u0435\u0446\u044c:"}),(0,T.jsxs)("p",{children:[c.customerSecondName," ",c.customerFirstName]}),(0,T.jsxs)("p",{children:["\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0443: ",c.customerTel]})]}),(0,T.jsxs)("div",{className:Z,children:[(0,T.jsxs)("p",{children:["\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f \u2116 ",n]}),(0,T.jsx)("p",{children:s})]})]}),(0,T.jsx)(x.Z,{productsForOrder:u,products:a}),(0,T.jsx)(_.Z,{type:"button",btnClass:"btnLight",text:"\u041f\u0438\u0442\u0430\u043d\u043d\u044f \u043f\u043e\u043a\u0443\u043f\u0446\u044e",handleClick:function(){return e=a[0]._id,t=c.customerId,te(!0),ae(e),void oe(t);var e,t}}),(0,T.jsxs)("div",{className:S,children:[!0===i?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(_.Z,{type:"button",btnClass:"btnLight",text:"\u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",handleClick:function(){return le(t,!0,"sales")}}),(0,T.jsx)(_.Z,{type:"button",btnClass:"btnDark",text:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",handleClick:function(){return le(t,!1,"cancel")}})]}):(0,T.jsx)("p",{className:C,children:!0===o?"\u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u043e":"\u0421\u043a\u0430\u0441\u043e\u0432\u0430\u043d\u043e"}),(0,T.jsx)("p",{className:y,children:"\u0421\u0443\u043c\u0430 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f: ".concat(r," \u0433\u0440\u043d.")})]}),!1===i&&(0,T.jsx)("div",{className:M,children:!d&&(0,T.jsx)(_.Z,{btnClass:"btnLight",text:"\u0417\u0430\u043b\u0438\u0448\u0438\u0442\u0438 \u0432\u0456\u0434\u0433\u0443\u043a",handleClick:function(){return de(t,l,u,c.customerId)}})}),J&&(0,T.jsx)(p.Z,{hideWindow:de,orderToFeedbackWindow:K,feedbackType:"asSeller"})]},t)}))}),!t&&0===F.length&&(0,T.jsx)("p",{className:D,children:"\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044c \u0437 \u0442\u0430\u043a\u0438\u043c \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c \u0443 \u0432\u0430\u0441 \u0449\u0435 \u043d\u0435\u043c\u0430\u0454"})]}),B>1&&(0,T.jsx)(f.Z,{totalPages:B,currentPage:W,onPageChange:function(e){A(e),window.scrollTo({top:0,behavior:"smooth"})}}),ee&&(0,T.jsxs)("div",{className:I,children:[(0,T.jsx)("button",{className:k,onClick:function(){te(!1),ae(""),oe("")},children:(0,T.jsx)(v.G,{icon:g.NBC,size:"lg"})}),(0,T.jsx)(m.Z,{productInfo:{_id:ne,owner:r,customer:ie}})]})]})}}}]);
//# sourceMappingURL=795.ac35aca1.chunk.js.map