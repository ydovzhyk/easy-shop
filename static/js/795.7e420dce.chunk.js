"use strict";(self.webpackChunkeasy_shop=self.webpackChunkeasy_shop||[]).push([[795],{9803:function(e,t,r){r.d(t,{Z:function(){return k}});var s=r(5861),n=r(885),a=r(4687),u=r.n(a),c=r(2791),i=r(9434),o=r(7689),l=r(4676),d=r(9869),x=r(2205),f=r(2951),_=r(3214),h=r(4387),p=r(9833),m="Dialogue_dialogueContainer__FuS7j",g="Dialogue_additionalOpts__o-iwF",v="Dialogue_avatar__Snahc",j="Dialogue_textInputArea__7QqLK",w="Dialogue_dialogueGroup__CccDt",N="Dialogue_dialogueGroupCustomer__bT6EX",Z="Dialogue_dialogueBox__Zqye0",b="Dialogue_dialogueMessage__tL3Cl",y="Dialogue_dialogueMessageRight__KBBVw",C="Dialogue_textDate__qAQ-I",S="Dialogue_textarea__F4Goc",D="Dialogue_questionButton__et0nJ",I=r(184),k=function(e){var t=e.productInfo,r=(0,i.I0)(),a=(0,o.s0)(),k=t._id,M=t.owner,T=t.userDialogue,F=t.customer,B=(0,i.v9)(d.Dm),E=(0,i.v9)(d.PR),L=(0,i.v9)(d.t2),O=(0,i.v9)(x.kr),W=(0,i.v9)(x.J$),A=(0,c.useState)(""),R=(0,n.Z)(A,2),z=R[0],P=R[1],q=(0,c.useState)(!1),G=(0,n.Z)(q,2),U=G[0],J=G[1],H=(0,c.useState)(null),Q=(0,n.Z)(H,2),V=Q[0],X=Q[1],K=(0,c.useState)(null),$=(0,n.Z)(K,2),Y=$[0],ee=$[1],te=(0,c.useRef)(!1),re=(0,i.v9)(x.iH),se=[],ne=[],ae=!1;(0,c.useEffect)((function(){k&&!F&&X(k),k&&F&&(X(k),ee(F))}),[k,F]),(0,c.useEffect)((function(){if(O.length>0&&!W){var e=O.filter((function(e){return e.newMessages.some((function(e){return e.userReceiver===E._id}))})),t=re._id?re._id:T;e.some((function(e){return e._id===t}))&&(r((0,f.vz)(!0)),r((0,f.qy)(t)))}}),[r,O,E._id,re._id,T,W]),(0,c.useEffect)((function(){var e=function(){var e=(0,s.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te.current=!1,J(!1),r((0,f.ve)()),r((0,f.vz)(!1)),V&&L&&!T){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,r((0,l.UA)({productId:V,customerId:Y}));case 8:J(!0);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r,V,T,L,W,Y]),(0,c.useEffect)((function(){var e=function(){var e=(0,s.Z)(u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(te.current=!1,J(!1),r((0,f.ve)()),r((0,f.vz)(!1)),T){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,r((0,l.UA)({dialogueId:T}));case 8:J(!0);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[r,T,W]),(0,c.useEffect)((function(){if(0!==re.length&&!te.current&&0!==re.newMessages.length){var e=re._id,t=re.newMessages,n=E._id,a=t.filter((function(e){return e.userReceiver===n})),c=function(){var t=(0,s.Z)(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!te.current){t.next=2;break}return t.abrupt("return");case 2:return te.current=!0,t.next=5,r((0,l.k1)({dialogueId:e,arrayNewMessage:a}));case 5:return t.next=7,r((0,f.fm)(e));case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),i=setTimeout(c,2e4);return function(){clearTimeout(i),c()}}}),[r,re,E._id]);0===re.length?(se=[],ne=[]):(se=re.messageArray.slice().reverse(),ne=re.newMessages,function(e){ae="64cccb7e5b8c2eb706fe655d"===e[0].textOwner}(se));var ue=function(e){var t="",r="",s=re.userAvatar,n=re.productOwnerAvatar;return E.userAvatar===s?(t=s,r=n):(t=n,r=s),e===E._id?t:r},ce=function(){var e=(0,s.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,r((0,l.Jc)({text:z,productId:V,productOwner:M,dialogueId:re._id,customerId:Y}));case 3:P(""),e.next=8;break;case 6:return a("/login"),e.abrupt("return");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(e,t){if(!ne||0===ne.length)return!1;var r=E._id;return 0!==ne.filter((function(s){return s.userReceiver===r&&s.message===e&&s.date===t})).length};return(0,I.jsx)(I.Fragment,{children:U&&(0,I.jsxs)("div",{className:m,children:[!ae&&(0,I.jsxs)("div",{className:g,children:[!Y&&(0,I.jsx)(_.Z,{text:"\u0417\u0430\u043f\u0438\u0442\u0430\u0442\u0438",textClass:"productText"}),Y&&(0,I.jsx)(_.Z,{text:"\u0417\u0430\u043f\u0438\u0442\u0430\u0442\u0438 \u043f\u043e\u043a\u0443\u043f\u0446\u044f",textClass:"productText"})]}),0===se.length&&(0,I.jsx)("div",{className:v,children:(0,I.jsx)(h.Z,{avatarClass:"photoDialogueLeft",src:B})}),se.length>0&&(0,I.jsx)("ul",{className:Y?N:w,children:se.map((function(e,t){return(0,I.jsx)("li",{children:(0,I.jsx)("div",{className:Z,children:e.textOwner===E._id?(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(h.Z,{avatarClass:"photoDialogueLeft",src:ue(e.textOwner)}),(0,I.jsxs)("div",{className:b,children:[(0,I.jsx)(_.Z,{text:e.text,textClass:ie(e.text,e.date)?"productTextDialogueNewMessage":"productTextDialogue"}),(0,I.jsx)("div",{className:C,children:(0,I.jsx)(_.Z,{text:e.date,textClass:"productTextDate"})})]})]}):(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{className:y,children:[(0,I.jsx)(_.Z,{text:e.text,textClass:ie(e.text,e.date)?"productTextDialogueNewMessage":"productTextDialogue"}),(0,I.jsx)("div",{className:C,children:(0,I.jsx)(_.Z,{text:e.date,textClass:"productTextDate"})})]}),(0,I.jsx)(h.Z,{avatarClass:"photoDialogueRight",src:ue(e.textOwner)})]})})},t)}))}),!ae&&(0,I.jsxs)("div",{className:j,children:[(0,I.jsx)("textarea",{className:S,name:"myQuestion",value:z,onChange:function(e){P(e.target.value)},rows:5,cols:40}),(0,I.jsxs)("div",{className:D,children:[(0,I.jsx)(p.Z,{text:L?"\u041d\u0430\u0434\u0456\u0441\u043b\u0430\u0442\u0438":"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044f",btnClass:"btnLight",handleClick:function(){return ce(L)}}),!L&&(0,I.jsx)(_.Z,{text:"*\u0429\u043e\u0431 \u043d\u0430\u043f\u0438\u0441\u0430\u0442\u0438 \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u044e, \u0443\u0432\u0456\u0439\u0434\u0456\u0442\u044c \u0432 \u043e\u0431\u043b\u0456\u043a\u043e\u0432\u0438\u0439 \u0437\u0430\u043f\u0438\u0441 \u0430\u0431\u043e \u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0439\u0442\u0435\u0441\u044f",textClass:"messageTextBtn"})]})]})]})})}},3537:function(e,t,r){r.r(t),r.d(t,{default:function(){return F}});var s=r(885),n=r(2791),a=r(9434),u=r(4347),c=r(8646),i=r(9869),o=r(9053),l=r(1970),d=r(4676),x=r(9462),f=r(5310),_=r(9833),h=r(7262),p=r(8064),m=r(9803),g=r(1632),v=r(9806),j="MySales_ordersWrapper__zezf+",w="MySales_ordersList__s6tus",N="MySales_orderItem__l-5wO",Z="MySales_orderInfoWrapper__rgdFU",b="MySales_orderInfoItem__zGXXl",y="MySales_orderSum__MPLUJ",C="MySales_orderBottomWrapper__P6Du2",S="MySales_waitingPhrase__o59Sm",D="MySales_message__x8quZ",I="MySales_messageWindow__BmH+V",k="MySales_dismissButton__9iaeT",M="MySales_buttonBottomWrapper__nRbFL",T=r(184),F=function(){var e=(0,a.I0)(),t=(0,a.v9)(c.Wc),r=(0,a.v9)(i.Vg),F=(0,a.v9)(c.ME),B=(0,a.v9)(c.pH),E=(0,a.v9)(o.UW),L=(0,n.useState)(1),O=(0,s.Z)(L,2),W=O[0],A=O[1],R=(0,n.useState)("all"),z=(0,s.Z)(R,2),P=z[0],q=z[1],G=(0,n.useState)(!1),U=(0,s.Z)(G,2),J=U[0],H=U[1],Q=(0,n.useState)({}),V=(0,s.Z)(Q,2),X=V[0],K=V[1],$=(0,n.useState)(!1),Y=(0,s.Z)($,2),ee=Y[0],te=Y[1],re=(0,n.useState)(null),se=(0,s.Z)(re,2),ne=se[0],ae=se[1],ue=(0,n.useState)(null),ce=(0,s.Z)(ue,2),ie=ce[0],oe=ce[1];(0,n.useEffect)((function(){e((0,l.Dy)({userId:r}))}),[e,r,X]),(0,n.useEffect)((function(){e((0,u.mN)({page:W,selectorName:P})),window.scrollTo({top:0,behavior:"smooth"})}),[e,W,P]);var le=function(t,r,s){e((0,u.E7)({orderId:t,confirmed:r,statusNew:!1})),e((0,u.mN)({page:W,selectorName:P})),e((0,d.al)({orderId:t,typeDialogue:s}))},de=function(e,t,r,s){if(e)return K({orderId:e,sellerId:t,productInfo:r,customerId:s}),void H(!J);K({}),H(!J)};return(0,n.useEffect)((function(){document.body.style.overflow=J?"hidden":"unset"}),[J]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:j,children:[(0,T.jsx)(h.Z,{currentSelector:P,handleButtonClick:function(e){q(e),A(1)}}),F.length>0&&(0,T.jsx)("ul",{className:w,children:F.map((function(e){var t=e._id,r=e.orderSum,s=e.orderDate,n=e.orderNumber,a=e.products,u=e.productInfo,c=e.client,i=e.statusNew,o=e.confirmed,l=e.sellerId,d=E.find((function(e){return e.orderId===t}));return(0,T.jsxs)("li",{className:N,children:[(0,T.jsxs)("div",{className:Z,children:[(0,T.jsxs)("div",{className:b,children:[(0,T.jsx)("p",{children:"\u041f\u043e\u043a\u0443\u043f\u0435\u0446\u044c:"}),(0,T.jsxs)("p",{children:[c.customerSecondName," ",c.customerFirstName]}),(0,T.jsxs)("p",{children:["\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0443: ",c.customerTel]})]}),(0,T.jsxs)("div",{className:b,children:[(0,T.jsxs)("p",{children:["\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f \u2116 ",n]}),(0,T.jsx)("p",{children:s})]})]}),(0,T.jsx)(x.Z,{productsForOrder:u,products:a}),(0,T.jsxs)("div",{className:C,children:[!0===i?(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(_.Z,{type:"button",btnClass:"btnLight",text:"\u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",handleClick:function(){return le(t,!0,"sales")}}),(0,T.jsx)(_.Z,{type:"button",btnClass:"btnDark",text:"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f",handleClick:function(){return le(t,!1,"cancel")}})]}):(0,T.jsx)("p",{className:S,children:!0===o?"\u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0436\u0435\u043d\u043e":"\u0421\u043a\u0430\u0441\u043e\u0432\u0430\u043d\u043e"}),(0,T.jsx)("p",{className:y,children:"\u0421\u0443\u043c\u0430 \u0437\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u043d\u044f: ".concat(r," \u0433\u0440\u043d.")})]}),!1===i&&(0,T.jsxs)("div",{className:M,children:[(0,T.jsx)(_.Z,{type:"button",btnClass:"btnLight",text:"\u041f\u0438\u0442\u0430\u043d\u043d\u044f \u043f\u043e\u043a\u0443\u043f\u0446\u044e",handleClick:function(){return e=a[0]._id,t=c.customerId,te(!0),ae(e),void oe(t);var e,t}}),!d&&(0,T.jsx)(_.Z,{btnClass:"btnLight",text:"\u0417\u0430\u043b\u0438\u0448\u0438\u0442\u0438 \u0432\u0456\u0434\u0433\u0443\u043a",handleClick:function(){return de(t,l,u,c.customerId)}})]}),J&&(0,T.jsx)(p.Z,{hideWindow:de,orderToFeedbackWindow:X,feedbackType:"asSeller"})]},t)}))}),!t&&0===F.length&&(0,T.jsx)("p",{className:D,children:"\u0417\u0430\u043c\u043e\u0432\u043b\u0435\u043d\u044c \u0437 \u0442\u0430\u043a\u0438\u043c \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u043c \u0443 \u0432\u0430\u0441 \u0449\u0435 \u043d\u0435\u043c\u0430\u0454"})]}),B>1&&(0,T.jsx)(f.Z,{totalPages:B,currentPage:W,onPageChange:function(e){A(e),window.scrollTo({top:0,behavior:"smooth"})}}),ee&&(0,T.jsxs)("div",{className:I,children:[(0,T.jsx)("button",{className:k,onClick:function(){te(!1),ae(null),oe(null)},children:(0,T.jsx)(v.G,{icon:g.NBC,size:"lg"})}),(0,T.jsx)(m.Z,{productInfo:{_id:ne,owner:r,customer:ie}})]})]})}}}]);
//# sourceMappingURL=795.7e420dce.chunk.js.map